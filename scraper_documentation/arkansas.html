<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Process an image multiple times to increase chance of...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for arkansas_restruct"><tr><td>arkansas_restruct</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Process an image multiple times to increase chance of successful extraction</h2>

<h3>Description</h3>

<p>Sometimes an image cannot be extracted with the numbers placed
in a cell with the default values for extraction. In this case we loop over
several values of extraction parameters to try and get the cell values.
</p>


<h3>Usage</h3>

<pre>
arkansas_restruct(img, enhancements = seq(100, 500, by = 50))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>enhancements</code></td>
<td>
<p>list of enhancements to use for extraction</p>
</td></tr>
<tr valign="top"><td><code>url_</code></td>
<td>
<p>the url of the image</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with values extracted from image
</p>


</body></html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Scraper class for general Arkansas COVID data</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for arkansas_scraper"><tr><td>arkansas_scraper</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Scraper class for general Arkansas COVID data</h2>

<h3>Description</h3>

<p>AR data is downloaded from a new weekly image which undergoes
OCR. Can be temperamental. Check logs frequently as AR has changed the
data reported twice in the past. Need to combine Residents Recovered with
Residents Positive Not Recovered to get total confirmed.
</p>

<dl>
<dt>Residents Tested</dt><dd><p>Residents Tested.</p>
</dd>
<dt>Residents Recovered</dt><dd><p>Residents Recovered.</p>
</dd>
<dt>Residents Positive Not Recovered</dt><dd><p>Residents Positive Not Recovered.</p>
</dd>
<dt>Staff Tested</dt><dd><p>Staff Tested. No Longer Reported.</p>
</dd>
<dt>Staff Recovered</dt><dd><p>Staff Recovered. No longer reported.</p>
</dd>
<dt>Staff Positive Not Recovered</dt><dd><p>Staff Positive Not Recovered.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The last run of the scraper was on 2021-01-11 and contained the extracted columns: Residents.Tested, Residents.Recovered, Name, Residents.Active, Residents.Confirmed, State, Date, id, source, jurisdiction. We are missing the following core variables for the analysis: Staff.Confirmed, Staff.Deaths, Residents.Deaths, Staff.Recovered, Staff.Tested, Residents.Tadmin, Staff.Negative, Residents.Negative, Staff.Pending, Residents.Pending, Staff.Quarantine, Residents.Quarantine, Residents.Population
</p>


<h3>Super class</h3>

<p><code>R_GlobalEnv::generic_scraper</code> -&gt; <code>arkansas_scraper</code>
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-new"><code>arkansas_scraper$new()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>arkansas_scraper$clone()</code></a>
</p>
</li></ul>



<details ><summary>Inherited methods</summary>

<ul>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="extract_from_raw"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-extract_from_raw"><code>R_GlobalEnv::generic_scraper$extract_from_raw()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="get_previous_run_dates"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-get_previous_run_dates"><code>R_GlobalEnv::generic_scraper$get_previous_run_dates()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="last_update"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-last_update"><code>R_GlobalEnv::generic_scraper$last_update()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="manual_change"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-manual_change"><code>R_GlobalEnv::generic_scraper$manual_change()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="perma_save"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-perma_save"><code>R_GlobalEnv::generic_scraper$perma_save()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="print"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-print"><code>R_GlobalEnv::generic_scraper$print()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="pull_raw"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-pull_raw"><code>R_GlobalEnv::generic_scraper$pull_raw()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="pull_wayback_raw"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-pull_wayback_raw"><code>R_GlobalEnv::generic_scraper$pull_wayback_raw()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="reset_date"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-reset_date"><code>R_GlobalEnv::generic_scraper$reset_date()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="restruct_raw"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-restruct_raw"><code>R_GlobalEnv::generic_scraper$restruct_raw()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="run_all"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-run_all"><code>R_GlobalEnv::generic_scraper$run_all()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="save_extract"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-save_extract"><code>R_GlobalEnv::generic_scraper$save_extract()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="save_raw"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-save_raw"><code>R_GlobalEnv::generic_scraper$save_raw()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="validate_extract"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-validate_extract"><code>R_GlobalEnv::generic_scraper$validate_extract()</code></a></span>
</p>
</li>
<li> <span class="pkg-link" data-pkg="R_GlobalEnv" data-topic="generic_scraper" data-id="validate_process"><p><a href="../../R_GlobalEnv/html/generic_scraper.html#method-validate_process"><code>R_GlobalEnv::generic_scraper$validate_process()</code></a></span>
</p>
</li></ul>

</details>

<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>arkansas_scraper$new(
  log,
  url = "https://doc.arkansas.gov/covid-19-updates/",
  id = "arkansas",
  state = "AR",
  type = "img",
  jurisdiction = "state",
  pull_func = function(x) {     magick::image_read(get_src_by_attr(base = x, css = "a",
    attr = "href", attr_regex = "(?i)stats.?update", date_regex =
    "\\d+-\\d+-\\d+")) },
  restruct_func = function(x, ...) arkansas_restruct(x, ...),
  extract_func = arkansas_extract
)</pre></div>


<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>arkansas_scraper$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




</body></html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Process an image multiple times to increase chance of...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for arkansas_extract"><tr><td>arkansas_extract</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Process an image multiple times to increase chance of successful extraction</h2>

<h3>Description</h3>

<p>Sometimes an image cannot be extracted with the numbers placed
in a cell with the default values for extraction. In this case we loop over
several values of extraction parameters to try and get the cell values.
</p>


<h3>Usage</h3>

<pre>
arkansas_extract(x)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>url_</code></td>
<td>
<p>the url of the image</p>
</td></tr>
<tr valign="top"><td><code>enhancements</code></td>
<td>
<p>list of enhancements to use for extraction</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with values extracted from image
</p>


</body></html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Crop out a cell in the AR image and extract the numeric value</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for process_AR_cell"><tr><td>process_AR_cell</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Crop out a cell in the AR image and extract the numeric value</h2>

<h3>Description</h3>

<p>the data for AR numbers come from a PNG with consistent
formatting. the goal of this function is to isolate the cell with a single
numeric value using the crop argument, enhance the image, and then extract
the number value using OCR. Note that converting to gray-scale will help
this process and if we can invert the colors that would probably be even 
better. enhancement
</p>


<h3>Usage</h3>

<pre>
process_AR_cell(base_image, crop, enhancement = 500)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>base_image</code></td>
<td>
<p>image loaded into R using the magick package</p>
</td></tr>
<tr valign="top"><td><code>crop</code></td>
<td>
<p>the area to crop the image</p>
</td></tr>
<tr valign="top"><td><code>enhancement</code></td>
<td>
<p>what size to blow up the image to</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric value of specified cell.
</p>


</body></html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Extract information from all cells in an AR image.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for process_AR_image"><tr><td>process_AR_image</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Extract information from all cells in an AR image.</h2>

<h3>Description</h3>

<p>Get all information from an AR image cells and place in tibble.
NOTE: THIS ONLY WORKS WIH A PARTICULAR IMAGE FORMAT AND ANOTHER SET
OF CROPPPING AREAS WILL LIKELY BE NEEDED IF THIS CHANGES.
</p>


<h3>Usage</h3>

<pre>
process_AR_image(base_image, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>...</code></td>
<td>
<p>other arguments to pass to process_AR_cell</p>
</td></tr>
<tr valign="top"><td><code>image</code></td>
<td>
<p>loaded into R using the magick package</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with values extracted from image
</p>


</body></html>

